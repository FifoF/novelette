%% This is file `novelette-footnotes.sty',
%% part of `novelette' document class.
%% Copyright 2023 Robert Allgeyer.
%%
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3c
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.3c or later is part of all distributions of LaTeX
%% version 2005/12/01 or later. 
%%
\ProvidesFile{novelette-footnotes.sty}%
[2023/01/20 v0.2 LaTeX file (commands for footnotes)]
%%


%% FOOTNOTES
% \footnote is a built-in TeX macro. Novelette allows you to use either
% literary markers (asterisk, dagger, etc.) or numerical markers.
%   You may also write a footnote without any marker (preferred style when
% footnote is on an opening or display page).


%% WITHOUT MARKER
\newcommand\footnotez[1]{{\nvt@fnzmarktrue\footnote{#1}}}
%%


%% RULE (Separator between main text and footnote)
\def\footnoterule{%
  \vfill\vspace{-\nvt@leading}%
  \noindent\strut\smash{\rule[-2pt]{0.33\textwidth}{0.05\nvt@fontsize}}%
  \ifnvt@fnleft\hfill\rule{1pt}{0pt}\fi%
}
%%


%% REFERENCE MARKS
% Also known as markers. Style selection is in novelette-design.
% \@makefnmark is an existing LaTeX macro, redefined here. Marker in main text.
\newcounter{nvt@fnmnum} % Which marker in the list.
\setcounter{nvt@fnmnum}{1}
\def\@makefnmark{\ifnvt@fnzmark\else\nvt@getfnmark\fi}
\def\nvt@getfnmark{% Places marker in the main text.
  \ifnvt@fnseq%
    \gdef\nvt@fnm{\the\value{nvt@fnmnum}}%
  \else%
    \ifthenelse{\equal{\value{nvt@fnmnum}}{1}}{\gdef\nvt@fnm{*}}{}%
    \ifthenelse{\equal{\value{nvt@fnmnum}}{2}}{\gdef\nvt@fnm{†}}{}%
    \ifthenelse{\equal{\value{nvt@fnmnum}}{3}}{\gdef\nvt@fnm{‡}}{}%
    \ifthenelse{\equal{\value{nvt@fnmnum}}{4}}{\gdef\nvt@fnm{§}}{}%
    \ifthenelse{\equal{\value{nvt@fnmnum}}{5}}{\gdef\nvt@fnm{**}}{}%
    \ifthenelse{\equal{\value{nvt@fnmnum}}{6}}{\gdef\nvt@fnm{††}}{}%
    \ifthenelse{\equal{\value{nvt@fnmnum}}{7}}{\gdef\nvt@fnm{‡‡}}{}%
    \ifthenelse{\equal{\value{nvt@fnmnum}}{8}}{\gdef\nvt@fnm{§§}}{}%
  \fi%
  {\addfontfeature{VerticalPosition=Superior}\nvt@fnm}%
}
\def\nvt@bfnm{% Bottom footnote marker.
  \nvt@fnm%
  \ifnvt@fnseq%
    {.}\stepcounter{nvt@fnmnum}%
  \else%
    \ifthenelse{\equal{\value{nvt@fnmnum}}{8}}{%
      \setcounter{nvt@fnmnum}{1}%
    }{\stepcounter{nvt@fnmnum}}%
  \fi%
}
%%


%% FOOTNOTE TEXT
% The actual footnote, at bottom of textblock, text in \@footnotesize.
\long\def\nvt@makefntext#1{%
  \ifnvt@fnindent%
    \ifnvt@fnzmark\forceindent{#1}\else\forceindent\nvt@bfnm\,{#1}\fi%
  \else%
    \ifnvt@fnzmark\noindent{#1}\else\noindent\nvt@bfnm\,{#1}\fi%
  \fi%
}
\long\def\@footnotetext#1{
  \insert\footins{%
    \reset@font\@footnotesize
    \interlinepenalty\interfootnotelinepenalty
    \splittopskip\footnotesep
    \splitmaxdepth \dp\strutbox \floatingpenalty \@MM
    \hsize\columnwidth \@parboxrestore
    \def\@currentcounter{footnote}%
    \protected@edef\@currentlabel{\csname p@footnote\endcsname\@thefnmark}%
    \nvt@makefntext{\rule{0pt}{\footnotesep}%
      \ignorespaces#1\@finalstrut\strutbox}\par%
  }
}%
%%


%% Pertains to some standard LaTeX footnote code:
\AtBeginShipout{\gdef\@fnafter{}}
%%


%%
\endinput
%%
%% End of file `novelette-footnotes.sty'.

